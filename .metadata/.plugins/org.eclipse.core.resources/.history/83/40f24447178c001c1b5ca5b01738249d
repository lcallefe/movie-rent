package StepDefinitions;

import static org.junit.Assert.assertEquals;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

import cucumber.api.Transform;
import cucumber.api.java.en.Given;
import cucumber.api.java.en.Then;
import cucumber.api.java.en.When;

public class DelayInDelivery {
	
	Date delivery = new Date();
	
	//@Transform vai converter a string recebida pruma data
	@Given("^the delivery time is (.*)$")
	public void theDeliveryTimeIs(@Transform(DateConverter.class) Date date) throws Throwable {
	    delivery = date;
	    
	}

	@When("^the delivery delays in (\\d+) (day|days|month|months)$")
	public void theDeliveryDelaysIn(int day_or_month, String time) {
		
		Calendar cal = Calendar.getInstance();
		cal.setTime(delivery);
		if (time.equalsIgnoreCase("days") || time.equalsIgnoreCase("day"))
			cal.add(Calendar.DAY_OF_MONTH, day_or_month);
		else
			cal.add(Calendar.MONTH, day_or_month); //will add months instead of days
		delivery = cal.getTime();

	}

	@Then("^the delivery will occur in (\\d{2}\\/\\d{2}\\/\\d{4})$")
	public void theDeliveryWillOccurIn(String date) {
		DateFormat format = new SimpleDateFormat("dd/MM/yyyy");
		String formattedDate = format.format(delivery);
		assertEquals(date, formattedDate);
		
	    
	}

}
